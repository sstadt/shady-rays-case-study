{%- comment -%}
  snippets/product-badge.liquid

  Renders a SALE badge when any variant has compare_at_price > price.
  Hides the badge (display:none) if the selected/first variant isn't on sale.

  NOTES: This could be expanded for other tags i.e. NEW, FEATURED, HOT ITEM, etc.
         These could be configured to display based on tags, metafields, theme
         setting, or other misc product information.

         Centralizing tags here would make them easier to maintain, and switching
         from image-based tags to CSS-styled tags (since the current tags on site are
         achievable with simple styling) would reduce the number of assets users need
         to download.

  Usage: {%- render 'product-badges', product: product -%}
{%- endcomment -%}

{%- liquid
  assign any_variant_on_sale = false
  for variant in product.variants
    if variant.compare_at_price != blank and variant.compare_at_price > variant.price
      assign any_variant_on_sale = true
      break
    endif
  endfor

  assign current_variant = product.selected_or_first_available_variant
  assign current_variant_on_sale = false
  if current_variant.compare_at_price != blank and current_variant.compare_at_price > current_variant.price
    assign current_variant_on_sale = true
  endif
-%}

{%- if any_variant_on_sale -%}
  <span
    class="product-badge product-badge--sale"
    role="status"
    aria-label="Sale"
    {% unless current_variant_on_sale %} style="display:none;"{% endunless %}
  >
    SALE
  </span>
{%- endif -%}
